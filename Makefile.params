# Core Parameter System Test Makefile
CXX = g++
CXXFLAGS = -std=c++17 -O2 -Wall -Wextra
INCLUDES = -I. -Isrc -Isrc/core
LIBS = -pthread

# Core parameter test
test_core_parameters: test_core_parameters.cpp src/core/CoreParameters.h src/core/PostChainProcessor.h
	@echo "ğŸ”¨ Compiling core parameter system test..."
	$(CXX) $(CXXFLAGS) $(INCLUDES) -o $@ test_core_parameters.cpp $(LIBS)
	@echo "âœ… Built: $@"

# Run the test
test-params: test_core_parameters
	@echo "ğŸ§ª Testing core parameter system..."
	./test_core_parameters
	@echo "âœ… Core parameter tests completed"

# Build and test parameter system integration
test-param-integration: test_core_parameters
	@echo "ğŸ”— Testing parameter system integration..."
	@echo "Running parameter scaling tests..."
	./test_core_parameters | grep -E "(âœ…|âŒ|Testing|Output)"
	@echo "ğŸ¯ Integration test completed"

# Clean test artifacts
clean-params:
	@echo "ğŸ§¹ Cleaning parameter test artifacts..."
	rm -f test_core_parameters
	@echo "âœ… Clean complete"

# Help for parameter testing
help-params:
	@echo "ğŸ“‹ Core Parameter System Test Targets:"
	@echo "=================================="
	@echo "  test-params           - Build and run parameter system tests"
	@echo "  test-param-integration - Run integration tests with output filtering"
	@echo "  clean-params          - Clean test artifacts"
	@echo "  help-params           - Show this help"
	@echo ""
	@echo "Test Coverage:"
	@echo "  âœ“ 16-parameter structure and defaults"
	@echo "  âœ“ Parameter scaling (linear/exponential/quadratic)"
	@echo "  âœ“ Post-chain fallback processing"  
	@echo "  âœ“ Parameter validation and bounds checking"
	@echo "  âœ“ Stereo processing and pan law"
	@echo "  âœ“ ADSR envelope integration"
	@echo ""
	@echo "Usage:"
	@echo "  make -f Makefile.params test-params"

.PHONY: test-params test-param-integration clean-params help-params